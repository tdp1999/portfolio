<ui-sidebar-provider class="h-dvh bg-background">
  <ui-sidebar>
    <!-- Header: Console branding -->
    <ui-sidebar-header routerLink="/" class="cursor-pointer">
      <div
        data-sidebar-icon
        class="flex h-8 w-8 shrink-0 items-center justify-center rounded-md bg-primary text-text-on-primary text-sm font-bold"
      >
        C
      </div>
      <div class="flex items-center gap-2 px-1 w-full">
        <div class="flex min-w-0 flex-col">
          <span class="truncate text-sm font-semibold text-text">Console</span>
          <span class="truncate text-xs text-text-muted">Portfolio Management</span>
        </div>
      </div>
    </ui-sidebar-header>

    <ui-sidebar-content>
      <!-- Main navigation -->
      <ui-sidebar-group label="Navigation">
        <ul uiSidebarMenu>
          <li uiSidebarMenuItem>
            <button ui-sidebar-menu-button tooltip="Dashboard">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">dashboard</mat-icon>
              <span>Dashboard</span>
            </button>
          </li>

          <li uiSidebarMenuItem>
            <button ui-sidebar-menu-button tooltip="Projects">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">view_list</mat-icon>
              <span>Projects</span>
            </button>
          </li>

          <li uiSidebarMenuItem>
            <button ui-sidebar-menu-button tooltip="Content">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">article</mat-icon>
              <span>Content</span>
            </button>
          </li>

          <li uiSidebarMenuItem>
            <button ui-sidebar-menu-button tooltip="Analytics">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">analytics</mat-icon>
              <span>Analytics</span>
            </button>
          </li>
        </ul>
      </ui-sidebar-group>

      <div uiSidebarSeparator></div>

      <!-- Settings group -->
      <ui-sidebar-group label="System" [collapsible]="true">
        <ul uiSidebarMenu>
          <li uiSidebarMenuItem>
            <a routerLink="/ddl" ui-sidebar-menu-button tooltip="DDL">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">grid_on</mat-icon>
              <span>DDL</span>
            </a>
          </li>

          <li uiSidebarMenuItem>
            <a routerLink="/error/403" ui-sidebar-menu-button tooltip="403 Page">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">block</mat-icon>
              <span>403</span>
            </a>
          </li>

          <li uiSidebarMenuItem>
            <a routerLink="/error/404" ui-sidebar-menu-button tooltip="404 Page">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">help_outline</mat-icon>
              <span>404</span>
            </a>
          </li>

          <li uiSidebarMenuItem>
            <a routerLink="/error/500" ui-sidebar-menu-button tooltip="500 Page">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">warning</mat-icon>
              <span>500</span>
            </a>
          </li>

          <li uiSidebarMenuItem>
            <button ui-sidebar-menu-button tooltip="Settings" (click)="settingsSub.toggle()">
              <mat-icon data-sidebar-icon class="!h-4 !w-4 !text-[16px]">settings</mat-icon>
              <span>Settings</span>
            </button>
            <ui-sidebar-menu-sub #settingsSub>
              <li uiSidebarMenuSubItem>
                <a ui-sidebar-menu-sub-button routerLink="/settings/change-password" routerLinkActive>
                  Change Password
                </a>
              </li>
              <li uiSidebarMenuSubItem>
                <a
                  ui-sidebar-menu-sub-button
                  routerLink="/settings"
                  routerLinkActive
                  [routerLinkActiveOptions]="{ exact: true }"
                >
                  Profile
                </a>
              </li>
            </ui-sidebar-menu-sub>
          </li>
        </ul>
      </ui-sidebar-group>
    </ui-sidebar-content>

    <!-- Footer: User profile with Material Menu -->
    <ui-sidebar-footer>
      <div
        data-sidebar-icon
        class="flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-primary text-text-on-primary text-xs font-bold"
      >
        {{ userInitial() }}
      </div>
      <div class="flex items-center gap-2 px-1 w-full">
        <button [matMenuTriggerFor]="userMenu" class="flex min-w-0 flex-col text-left w-full cursor-pointer">
          <span class="truncate text-sm font-medium text-text">{{ user()?.name ?? 'User' }}</span>
          <span class="truncate text-xs text-text-muted">{{ user()?.email ?? '' }}</span>
        </button>

        <mat-menu #userMenu="matMenu" yPosition="above">
          <button mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>
            <span>Logout</span>
          </button>
          <button mat-menu-item (click)="logoutAll()">
            <mat-icon>devices</mat-icon>
            <span>Logout All Devices</span>
          </button>
        </mat-menu>
      </div>
    </ui-sidebar-footer>

    <ui-sidebar-rail />
  </ui-sidebar>

  <ui-sidebar-inset>
    <div class="flex items-center gap-2 border-b border-border px-4 py-2">
      <ui-sidebar-trigger />
      <h2 class="text-lg font-semibold text-text">Console</h2>
      <div class="ml-auto">
        <button mat-icon-button (click)="themeService.toggle()" [matTooltip]="themeTooltip()">
          <mat-icon>{{ themeIcon() }}</mat-icon>
        </button>
      </div>
    </div>
    <div class="p-6 overflow-auto w-full h-full [&>*]:mx-auto">
      <router-outlet />
    </div>
  </ui-sidebar-inset>
</ui-sidebar-provider>
